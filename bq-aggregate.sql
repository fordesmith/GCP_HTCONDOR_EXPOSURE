# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# bq-aggregate.sql
#
# each column in the table the predicted stock value for a given stock at 
# a particular day.  To generate the portfolio value, the query groups stocks 
# per simulation and sums the values for each stock.  

SELECT
  SUM(double_field_3),
  SUM(double_field_4),
  SUM(double_field_5),
  SUM(double_field_6),
  SUM(double_field_7),
  SUM(double_field_8),
  SUM(double_field_9),
  SUM(double_field_10),
  SUM(double_field_11),
  SUM(double_field_12),
  SUM(double_field_13),
  SUM(double_field_14),
  SUM(double_field_15),
  SUM(double_field_16),
  SUM(double_field_17),
  SUM(double_field_18),
  SUM(double_field_19),
  SUM(double_field_20),
  SUM(double_field_21),
  SUM(double_field_22),
  SUM(double_field_23),
  SUM(double_field_24),
  SUM(double_field_25),
  SUM(double_field_26),
  SUM(double_field_27),
  SUM(double_field_28),
  SUM(double_field_29),
  SUM(double_field_30),
  SUM(double_field_31),
  SUM(double_field_32),
  SUM(double_field_33),
  SUM(double_field_34),
  SUM(double_field_35),
  SUM(double_field_36),
  SUM(double_field_37),
  SUM(double_field_38),
  SUM(double_field_39),
  SUM(double_field_40),
  SUM(double_field_41),
  SUM(double_field_42),
  SUM(double_field_43),
  SUM(double_field_44),
  SUM(double_field_45),
  SUM(double_field_46),
  SUM(double_field_47),
  SUM(double_field_48),
  SUM(double_field_49),
  SUM(double_field_50),
  SUM(double_field_51),
  SUM(double_field_52),
  SUM(double_field_53),
  SUM(double_field_54),
  SUM(double_field_55),
  SUM(double_field_56),
  SUM(double_field_57),
  SUM(double_field_58),
  SUM(double_field_59),
  SUM(double_field_60),
  SUM(double_field_61),
  SUM(double_field_62),
  SUM(double_field_63),
  SUM(double_field_64),
  SUM(double_field_65),
  SUM(double_field_66),
  SUM(double_field_67),
  SUM(double_field_68),
  SUM(double_field_69),
  SUM(double_field_70),
  SUM(double_field_71),
  SUM(double_field_72),
  SUM(double_field_73),
  SUM(double_field_74),
  SUM(double_field_75),
  SUM(double_field_76),
  SUM(double_field_77),
  SUM(double_field_78),
  SUM(double_field_79),
  SUM(double_field_80),
  SUM(double_field_81),
  SUM(double_field_82),
  SUM(double_field_83),
  SUM(double_field_84),
  SUM(double_field_85),
  SUM(double_field_86),
  SUM(double_field_87),
  SUM(double_field_88),
  SUM(double_field_89),
  SUM(double_field_90),
  SUM(double_field_91),
  SUM(double_field_92),
  SUM(double_field_93),
  SUM(double_field_94),
  SUM(double_field_95),
  SUM(double_field_96),
  SUM(double_field_97),
  SUM(double_field_98),
  SUM(double_field_99),
  SUM(double_field_100),
  SUM(double_field_101),
  SUM(double_field_102),
  SUM(double_field_103),
  SUM(double_field_104),
  SUM(double_field_105),
  SUM(double_field_106),
  SUM(double_field_107),
  SUM(double_field_108),
  SUM(double_field_109),
  SUM(double_field_110),
  SUM(double_field_111),
  SUM(double_field_112),
  SUM(double_field_113),
  SUM(double_field_114),
  SUM(double_field_115),
  SUM(double_field_116),
  SUM(double_field_117),
  SUM(double_field_118),
  SUM(double_field_119),
  SUM(double_field_120),
  SUM(double_field_121),
  SUM(double_field_122),
  SUM(double_field_123),
  SUM(double_field_124),
  SUM(double_field_125),
  SUM(double_field_126),
  SUM(double_field_127),
  SUM(double_field_128),
  SUM(double_field_129),
  SUM(double_field_130),
  SUM(double_field_131),
  SUM(double_field_132),
  SUM(double_field_133),
  SUM(double_field_134),
  SUM(double_field_135),
  SUM(double_field_136),
  SUM(double_field_137),
  SUM(double_field_138),
  SUM(double_field_139),
  SUM(double_field_140),
  SUM(double_field_141),
  SUM(double_field_142),
  SUM(double_field_143),
  SUM(double_field_144),
  SUM(double_field_145),
  SUM(double_field_146),
  SUM(double_field_147),
  SUM(double_field_148),
  SUM(double_field_149),
  SUM(double_field_150),
  SUM(double_field_151),
  SUM(double_field_152),
  SUM(double_field_153),
  SUM(double_field_154),
  SUM(double_field_155),
  SUM(double_field_156),
  SUM(double_field_157),
  SUM(double_field_158),
  SUM(double_field_159),
  SUM(double_field_160),
  SUM(double_field_161),
  SUM(double_field_162),
  SUM(double_field_163),
  SUM(double_field_164),
  SUM(double_field_165),
  SUM(double_field_166),
  SUM(double_field_167),
  SUM(double_field_168),
  SUM(double_field_169),
  SUM(double_field_170),
  SUM(double_field_171),
  SUM(double_field_172),
  SUM(double_field_173),
  SUM(double_field_174),
  SUM(double_field_175),
  SUM(double_field_176),
  SUM(double_field_177),
  SUM(double_field_178),
  SUM(double_field_179),
  SUM(double_field_180),
  SUM(double_field_181),
  SUM(double_field_182),
  SUM(double_field_183),
  SUM(double_field_184),
  SUM(double_field_185),
  SUM(double_field_186),
  SUM(double_field_187),
  SUM(double_field_188),
  SUM(double_field_189),
  SUM(double_field_190),
  SUM(double_field_191),
  SUM(double_field_192),
  SUM(double_field_193),
  SUM(double_field_194),
  SUM(double_field_195),
  SUM(double_field_196),
  SUM(double_field_197),
  SUM(double_field_198),
  SUM(double_field_199),
  SUM(double_field_200),
  SUM(double_field_201),
  SUM(double_field_202),
  SUM(double_field_203),
  SUM(double_field_204),
  SUM(double_field_205),
  SUM(double_field_206),
  SUM(double_field_207),
  SUM(double_field_208),
  SUM(double_field_209),
  SUM(double_field_210),
  SUM(double_field_211),
  SUM(double_field_212),
  SUM(double_field_213),
  SUM(double_field_214),
  SUM(double_field_215),
  SUM(double_field_216),
  SUM(double_field_217),
  SUM(double_field_218),
  SUM(double_field_219),
  SUM(double_field_220),
  SUM(double_field_221),
  SUM(double_field_222),
  SUM(double_field_223),
  SUM(double_field_224),
  SUM(double_field_225),
  SUM(double_field_226),
  SUM(double_field_227),
  SUM(double_field_228),
  SUM(double_field_229),
  SUM(double_field_230),
  SUM(double_field_231),
  SUM(double_field_232),
  SUM(double_field_233),
  SUM(double_field_234),
  SUM(double_field_235),
  SUM(double_field_236),
  SUM(double_field_237),
  SUM(double_field_238),
  SUM(double_field_239),
  SUM(double_field_240),
  SUM(double_field_241),
  SUM(double_field_242),
  SUM(double_field_243),
  SUM(double_field_244),
  SUM(double_field_245),
  SUM(double_field_246),
  SUM(double_field_247),
  SUM(double_field_248),
  SUM(double_field_249),
  SUM(double_field_250),
  SUM(double_field_251),
  SUM(double_field_252),
  SUM(double_field_253),
  SUM(double_field_254)
  FROM montecarlo_outputs.vartable GROUP BY int64_field_2
